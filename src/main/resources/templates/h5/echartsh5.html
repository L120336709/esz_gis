<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('恩施地图')"/>
    <title>恩施地图</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes"/>
    <meta charset="UTF-8"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>首页</title>

    <style type="text/css">
        #id1 {
            border: 2px solid #0C1F34;
            height: 700px;
        }

        .my-skin .layui-layer-btn a {
            background-color: #0771E2;
            border: 1px solid #0771E2;
            color: #FFF;
        }

        .my-skin .layui-layer-title {
            color: #0771E2;
        }

        .btns {
            position: relative;
            background-color: rgba(12, 31, 52, 0);
            top: -47px;
            z-index: 100;
            /*font-size: 15px;*/
        }

        .btns div {
            background-color: #1A6173;
            border-radius: 5px;
            color: white;
            width: 70px;
            margin-right: 10px;
            text-align: center;
            float: left;
            border: 1px solid #0771E2;
            padding: 5px;
            font-weight: bold
        }


        .btnsbutton {
            padding: 5px;
            background-color: rgba(0, 0, 0, 0);
            border-radius: 5px;
            color: white;
            width: 60px;
            margin-right: 10px;
            text-align: center;
            cursor: pointer;
            float: left;
            border: 1px solid #0771E2;
        }

        .btnsbuttonon {
            font-weight: bold;
            background-color: #1A6173;
        }

        .select {
            width: 130px;

        }

        .select option {
            background-color: #0C1F34;
            padding: 2px;
        }

        .btnsbutton:hover {
            color: #01FFEE;
        }

        .imgs {
            position: relative;
            background-color: #0C1F34;
        }

        .imgs img {
            position: absolute;
            z-index: 99;
            background-color: #0C1F34;
            width: 100%;
            height: 100%;
        }

        .spans {
            position: relative;
            background-color: rgba(12, 31, 52, 0);
            top: -40px;
            z-index: 100;
            text-align: center;
        }

        .spans div {
            color: white;
            font-size: 25px
        }

        .title01 {
            font-size: 20px;
            color: #32AD0C;
            text-align: center;
        }

        .title02 {
            padding-left: 25%;
            padding-top: 20px;
            color: white;
            /*font-size: 16px;*/
        }

        .title02-1 {
            padding-top: 20px;
            width: 50%;
            float: left;
        }

        .title03 {
            padding-top: 5px;
            color: #35DEEB;
            font-weight: bold;
        }

        .title04 {
            font-size: 10px;
            padding: 20px 10%;
        }

        .title04 input {
            width: 60%;
            padding: 5px 10px;
            background-color: rgba(0, 0, 0, 0);
            border: 1px solid #35DEEB;
            border-radius: 5px;
            outline: none;
            color: white;
        }

        .title04 button {
            background-color: rgba(22, 155, 213, 0.8);
            border: none;
            color: white;
            padding: 5px 20px;
            border-radius: 5px;
        }

        .title04 button:hover {
            background-color: rgba(22, 155, 213, 1);
        }

        .title05 {
            text-align: center;
            margin-top: 5px;
        }

        .title05 div {
            float: left;
            width: calc(50% - 2px);
            height: 35px;
            /*margin-top: 20px;*/
        }

        .tutlebutton button {
            padding: 5px 25px !important;
        }

        .title05 button {
            width: 95%;
            background-color: #0A384A;
            color: #35DEEB;
            border: none;
            font-size: 10px;
            /*padding: 5px 25px;*/
            padding: 5px 10px;
            border: 1px solid #0C1F34;
        }

        .title05 button:hover {
            border: 1px solid #35DEEB;
        }


        .pages {
            text-align: center;
        }

        .pages span {
            font-size: 15px;
            color: rgba(255, 255, 255, 0.5);
            padding: 0 10px;
            cursor: pointer;
        }

        .pages span:hover {
            color: rgba(255, 255, 255, 1);;
        }

        .zsk {
            /*margin-left: 75px;*/
            margin-left: calc(50% - 220px);
            cursor: pointer;
        }

        .zsk:hover {
            color: #35DEEB;
        }

        .check {
            margin-left: 10px;
            /*margin-left: calc(50% - 220px);*/
            width: 100% !important;
        }


        .check p {
            background-color: #1A6173;
            color: #35DEEB;
            margin: 0;
            padding-left: 5px;
            float: left;
        }
    </style>

</head>

<body style="background-color: #0C1F34;width: 100%; ">
<div id="imgs" class="imgs">
    <img src="/img/bigdatatitle.png">
</div>
<div id="spans" class="spans">
    <div>恩施州智慧教育GIS看板</div>
</div>
<div id="btns" class="btns">
    <div id="gis02" style="width: 140px;margin-left: calc(15% - 75px)" hidden>概况信息窗</div>


    <button id="bt0" class="btnsbutton btnsbuttonon" onclick="changes(0)" style="cursor: pointer;margin-left: 10px">
        GIS地图
    </button>
    <button id="bt1" class="btnsbutton" onclick="changes(1)">概况</button>
    <button id="bt2" class="btnsbutton" onclick="changes(2)">列表</button>

    <button id="jbh" class="btnsbutton" onclick="setjbh(1)">仅名称</button>
    <button id="back" class="btnsbutton" onclick="getDitu('/js/json/enshizhou.json')">返回</button>

    <div id="gis03" style="width: 140px;margin-left: calc(35% - 290px)" hidden>列表信息窗</div>
</div>


<div id="gk" hidden style=" width: 100%;float: left;margin-top: -55px">
    <div class="title01" id="title02">恩施州教育局大数据</div>
    <div id="schooltj">
        <div class="title02">
            <div id="title01">恩施州教育局机构</div>
            <div class="title03" id="schooltj01">9个</div>
        </div>

        <div class="title02">
            <div class="title02-1">
                <div>幼儿园</div>
                <div class="title03" id="schooltj02"></div>
            </div>
            <div class="title02-1">
                <div>小学</div>
                <div class="title03" id="schooltj03"></div>
            </div>
        </div>
        <div class="title02">
            <div class="title02-1">
                <div>初中</div>
                <div class="title03" id="schooltj04"></div>
            </div>
            <div class="title02-1">
                <div>普通高中</div>
                <div class="title03" id="schooltj05"></div>
            </div>
        </div>
        <div class="title02">
            <div class="title02-1">
                <div>中职</div>
                <div class="title03" id="schooltj06"></div>
            </div>
            <div class="title02-1">
                <div>高职及大学</div>
                <div class="title03" id="schooltj07"></div>
            </div>
        </div>
    </div>

</div>
<div id="id2" style=";width: 100%;height:90%;float: left">
    <div class="check" id="schoolType" style="position: absolute;top: 110px " onchange="schoolTypeChange()">
        <p><input type="checkbox" name="schooltypes" title="幼儿园" value="幼儿园"/>幼 </p>
        <p><input type="checkbox" name="schooltypes" title="完全小学" value="完全小学"/>完小 </p>
        <p><input type="checkbox" name="schooltypes" title="小学教学点" value="小学教学点"/>点小</p>
        <p><input type="checkbox" name="schooltypes" title="初级中学" value="初级中学"/>初 </p>
        <p><input type="checkbox" name="schooltypes" title="完全中学" value="完全中学"/>完中 </p>
        <p><input type="checkbox" name="schooltypes" title="中职" value="中职"/>中职 </p>
        <p><input type="checkbox" name="schooltypes" title="特教学校" value="特教学校"/>特教 </p>
        <p><input type="checkbox" name="schooltypes" title="高级中学" value="高级中学"/>高 </p>
        <p><input type="checkbox" name="schooltypes" title="高职或大学" value="高职或大学"/>高&大 </p>
        <p><input type="checkbox" name="schooltypes" title="九年一贯制" value="九年一贯制"/>九 </p>
        <p><input type="checkbox" name="schooltypes" title="十二年一贯制" value="十二年一贯制"/>十二</p>
    </div>
    <div id="id1" style=" ;width: 100%;height:90%;float: left">
    </div>
</div>
<div id="lb" hidden style=" width: 100%;float: left;margin-top: -55px; ">
    <div class="title01" id="title03">恩施州教育局大数据</div>
    <div class="title04">
        <input id="schoolname" placeholder="请输入学校名称关键字查询">
        <button onclick="searchSchool()">搜索</button>
        <!--        <button>搜索</button>-->
    </div>
    <div class="title05 tutlebutton">
        <button style="height: 35px;width: auto">恩施州教育局</button>
    </div>
    <div id="schoollist">


        <div class="title05 tutlebutton">
            <div>
                <button>恩施市教育局</button>
            </div>
            <div>
                <button>利川市教育局</button>
            </div>
        </div>
        <div class="title05 tutlebutton">
            <div>
                <button>建始县教育局</button>
            </div>
            <div>
                <button>巴东县教育局</button>
            </div>
        </div>
        <div class="title05 tutlebutton">
            <div>
                <button>宣恩县教育局</button>
            </div>
            <div>
                <button>咸丰县教育局</button>
            </div>
        </div>
        <div class="title05 tutlebutton">
            <div>
                <button>来凤县教育局</button>
            </div>
            <div>
                <button>鹤峰县教育局</button>
            </div>
        </div>
        <div class="title05 tutlebutton">
            <div>
                <button style="padding: 5px 16px;">恩施州高级中学</button>
            </div>
        </div>
    </div>
</div>

<script src="/js/mmlib.min.js"></script>
<script src="/js/common.js"></script>
<script src="/js/json/new/echarts-all.min.js?v=20240221"></script>
<script src="/js/json/gis.js?v=20240223"></script>
<script type="text/javascript">

    var schoollistAll = null
    var schoollistnow = new Array()
    var schoolSeacrchList = new Array()
    var pagenow = 1
    var pageall = 1
    var cengshu = 2
    var getditus = [null, null, null, null, null]
    var zz = 0

    function changes(num) {
        document.getElementById("id2").hidden = true
        document.getElementById("gk").hidden = true
        document.getElementById("lb").hidden = true

        document.getElementById("bt0").className = "btnsbutton"
        document.getElementById("bt1").className = "btnsbutton"
        document.getElementById("bt2").className = "btnsbutton"

        if (num == 0) {
            document.getElementById("id2").hidden = false
            document.getElementById("bt0").className = "btnsbutton btnsbuttonon"
        } else if (num == 1) {
            document.getElementById("gk").hidden = false
            document.getElementById("bt1").className = "btnsbutton btnsbuttonon"
        } else if (num == 2) {
            document.getElementById("lb").hidden = false
            document.getElementById("bt2").className = "btnsbutton btnsbuttonon"
        }
    }

    function setjbh(num) {
        if (num == null) {
            getDitu(getditus[0], getditus[1], getditus[2], getditus[3], getditus[4], null)
            document.getElementById("jbh").onclick = function (ev) {
                setjbh(0)
            }
            document.getElementById("jbh").innerHTML = "仅名称"
        } else {
            getDitu(getditus[0], getditus[1], getditus[2], getditus[3], getditus[4], 1)
            document.getElementById("jbh").onclick = function (ev) {
                setjbh(null)
            }
            document.getElementById("jbh").innerHTML = "仅编号"
        }
    }

    function getJsonName(school) {
        var json, jyjname
        if (school.jyj == "恩施市教育局") {
            json = "/js/json/enshishi.json?v=20240220"
            jyjname = "恩施市"
        } else if (school.jyj == "利川市教育局") {
            json = "/js/json/lichuan.json"
            jyjname = "利川市"
        } else if (school.jyj == "建始县教育局") {
            json = "/js/json/jianshi.json"
            jyjname = "建始县"
        } else if (school.jyj == "巴东县教育局") {
            json = "/js/json/badong.json"
            jyjname = "巴东县"
        } else if (school.jyj == "宣恩县教育局") {
            json = "/js/json/xuanen.json"
            jyjname = "宣恩县"
        } else if (school.jyj == "咸丰县教育局") {
            json = "/js/json/xianfeng.json"
            jyjname = "咸丰县"
        } else if (school.jyj == "来凤县教育局") {
            json = "/js/json/laifeng.json"
            jyjname = "来凤县"
        } else if (school.jyj == "鹤峰县教育局") {
            json = "/js/json/hefeng.json"
            jyjname = "鹤峰县"
        }
        return json + "," + jyjname
    }

    function schoolTypeNUll() {
        var checkboxes = document.querySelectorAll('input[type="checkbox"]'); // 获取所有类型为checkbox的元素
        for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].checked = false
        }
    }

    function schoolTypeChange() {
        var arr = [];
        $('input:checkbox').each(function () {
            if ($(this).is(':checked')) { //判断选中
                arr.push($(this).val())
            }
        });
        var schoolType = document.getElementById("schoolType").value
        if (schoollistnow.length > 0) {
            var jons = getJsonName(schoollistnow[0]).split(",")
            var temp = null
            for (var i = 0; i < schoollistnow.length; i++) {
                if (temp == null) {
                    temp = schoollistnow[i].bsc
                } else {
                    if (temp != schoollistnow[i].bsc) {
                        temp = null
                        break
                    }
                }
            }
            if (temp != null) {
                temp = temp.substring(19)
            }
            var xiangzhenName = temp
            getDitu(jons[0], jons[1], xiangzhenName, null, arr)
            //console.log(jons[0]+jons[1]+ xiangzhenName)
        } else {
            getDitu("/js/json/enshizhou.json", null, null, null, arr, null)
        }
    }


    function toDh(j, w, name) {
        location.href = "https://uri.amap.com/marker?position=" + j + "," + w + "&name=" + name
    }

    function toJW(id){
        location.href = "https://kcgl.eszedu.com/h5/dwjw2024?id=" + id
    }
    //弹框显示学校名称、地点、图片信息等
    function show(i, j) {
        var name , address , bsc , coord ,id, picturelist
        var picture="<div style='padding:5px 0 0 10px' id='xxtp'>学校图片（学校账号可上传）：</div>"
        if (j == 1) {
            name = schoollistnow[i].name
            address = schoollistnow[i].address
            bsc = schoollistnow[i].bsc
            coord = schoollistnow[i].coord
            picturelist=schoollistnow[i].picture
            id=schoollistnow[i].id
        } else {
            name = schoollistAll[i].name
            address = schoollistAll[i].address
            bsc = schoollistAll[i].bsc
            coord = schoollistAll[i].coord
            picturelist=schoollistAll[i].picture
            id=schoollistAll[i].id
        }
        var pictures=[0,0]
        if( picturelist!=null){
            pictures=picturelist.split(",")
            if(schoolMes!=null) {
                if (schoolMes.realName != name) {
                    for(var p=0;p<pictures.length;p++){
                        if(pictures[p]!=0){
                            picture=picture  + "<div><img style='width: 200px;height: 100px;padding: 5px' src='"+pictures[p]+"'></div>"
                        }
                    }
                }
            }
        }

        var coordchange=""
        if(schoolMes!=null){
            if(schoolMes.realName==name){
                coordchange="<button onclick='toJW(\""+id+"\")'" +
                    "style='background-color: #00B4AA;color: white;border:none;border-radius: 5px'>更新</button>"
            }
        }

        layer.open({
            skin: 'demo-class',
            type: 1,
            closeBtn: 0,
            area: ['325px', '485px'],
            content: "<div style='padding:5px 0 0 10px'> <div>单位名称：" + name + "</div>"
                + "<div>单位地点：" + address + "</div>"
                + "<div>所属乡镇：" + bsc + "</div>"
                + "<div>经纬度：" +coord + coordchange+"</div>"
                + "<div>导航：<button onclick='toDh(" + coord + ",\"" + name + "\")' " +
                "style='background-color: #00B4AA;color: white;border:none;border-radius: 5px'>进入导航</button></div></div>"
                +picture,
            success: function(){
                if(schoolMes!=null) {
                    if (schoolMes.realName == name) {
                        //if(picturelist==null){
                            settp(id,"xxtp","学校图片",pictures[0],pictures[1])
                        //}
                    }
                }
            },
            btn: ['关闭'],
            btn1: function (index) {
                layer.close(index)
            }
        });
    }



    var schoollistpageNum = 20

    function pageTo(num, xiangzhenName) {
        if (num == -1) {
            if (pagenow > 1) {
                pagenow = pagenow - 1
            }
        }
        if (num == 1) {
            if (pagenow < pageall) {
                pagenow = pagenow + 1
            }
        }
        var schoollisthtml = ""
        if (schoollistnow.length > 0) {
            var pagelast = pagenow * schoollistpageNum
            if (schoollistnow.length < pagelast) {
                pagelast = schoollistnow.length
            }

            var bh = ""//getBh(schoollistnow[0].jyj.substring(0, 3))

            for (var i = (pagenow - 1) * schoollistpageNum; i < pagelast; i = i + 2) {

                var sch01 = schoollistnow[i].name
                var bhid = schoollistnow[i].value
                if (sch01.length > 10) {
                    sch01 = sch01.substring(3)
                    if (sch01.length > 10) {
                        sch01 = sch01.substring(0, 5) + "..." + sch01.substring(sch01.length - 5)
                    }
                }
                sch01 = bhid + sch01


                // var sch01 = schoollistnow[i].name
                // if (schoollistnow[i].name.length > 10) {
                //     sch01 = sch01.substring(3)
                //     if (sch01.length > 10) {
                //         sch01 = sch01.substring(0, 5) + "..." + sch01.substring(sch01.length - 5)
                //     }
                // }
                // if (xiangzhenName != null) {
                //     if (i + 1 < 10) {
                //         sch01 = bh + "00" + (i + 1) + sch01
                //     } else if (i + 1 < 100) {
                //         sch01 = bh + "0" + (i + 1) + sch01
                //     } else if (i + 1 < 1000) {
                //         sch01 = bh + (i + 1) + sch01
                //     }
                // }
                if (i + 1 < schoollistnow.length) {

                    // var sch02 = schoollistnow[i + 1].name
                    // if (schoollistnow[i + 1].name.length > 10) {
                    //     sch02 = sch02.substring(3)
                    //     if (sch02.length > 10) {
                    //         sch02 = sch02.substring(0, 5) + "..." + sch02.substring(sch02.length - 5)
                    //     }
                    // }
                    // if (xiangzhenName != null) {
                    //     if (i + 1 < 10) {
                    //         sch02 = bh + "00" + (i + 2) + sch02
                    //     } else if (i + 1 < 100) {
                    //         sch02 = bh + "0" + (i + 2) + sch02
                    //     } else if (i + 1 < 1000) {
                    //         sch02 = bh + (i + 2) + sch02
                    //     }
                    // }
                    var sch02 = schoollistnow[i + 1].name
                    var bhid2 = schoollistnow[i + 1].value
                    if (schoollistnow[i + 1].name.length > 10) {
                        sch02 = sch02.substring(3)
                        if (sch02.length > 10) {
                            sch02 = sch02.substring(0, 5) + "..." + sch02.substring(sch02.length - 5)
                        }
                    }
                    sch02 = bhid2 + sch02

                    schoollisthtml = schoollisthtml + " <div class=\"title05\">" +
                        "<div><button onclick='show(" + i + ",1)' title='" + schoollistnow[i].name + "' >" + sch01 + "</button></div>" +
                        "<div> <button onclick='show(" + (i + 1) + ",1)'title='" + schoollistnow[i + 1].name + "' >" + sch02 + "</button></div>" +
                        "</div>"

                } else {
                    schoollisthtml = schoollisthtml + " <div class=\"title05\">" +
                        "<div><button onclick='show(" + i + ",1)' title='" + schoollistnow[i].name + "'style=\"padding: 5px 16px;\">" + sch01 + "</button></div>" +
                        "</div>"
                }
            }
            pageall = Math.ceil(schoollistnow.length / schoollistpageNum)

            if (schoollistnow.length > schoollistpageNum) {
                schoollisthtml = schoollisthtml + "<div class='pages title05'><div style='width: 100%;'>" +
                    "<span onclick='pageTo(-1,\"" + xiangzhenName + "\")'>上一页</span>" +
                    "<span style='color: white;padding: 0 2px 0 10px'>" + pagenow + "</span>" +
                    "<span style='color: white;padding: 0 2px 0 2px'>/</span>" +
                    "<span style='color: white;padding: 0 10px 0 2px'>" + pageall + "</span>" +
                    "<span  onclick='pageTo(1,\"" + xiangzhenName + "\")'>下一页</span></div><div"
            }

        }
        document.getElementById("schoollist").innerHTML = schoollisthtml

    }

    var schooltjname = new Array()

    function schooltjlist(num, schooltj, jyjname, xiangzhenName) {
        //console.log(schooltj)
        schooltjname = new Array()
        var schooltjnum = new Array()

        for (var i = 0; i < schooltj.length; i++) {
            var boo = false
            for (var j = 0; j < schooltjname.length; j++) {
                if (schooltjname[j] == schooltj[i].schooltype) {
                    boo = true
                }
            }
            if (boo == false) {
                schooltjname.push(schooltj[i].schooltype)
            }
        }
        for (var i = 0; i < schooltjname.length; i++) {
            schooltjnum.push(0)
        }
        for (var i = 0; i < schooltj.length; i++) {
            for (var j = 0; j < schooltjname.length; j++) {
                if (schooltjname[j] == schooltj[i].schooltype) {
                    schooltjnum[j]++
                }
            }
        }
        //console.log(schooltjnum)


        var schooltjhtml = ""
        var jyjjg = ""
        var schooltj01 = ""

        if (num == 0) {
            jyjjg = "恩施州教育局机构"
            document.getElementById("title02").innerHTML = "恩施州教育大数据"
            document.getElementById("title03").innerHTML = "恩施州教育大数据"
            schooltj01 = "9个"
        } else if (num == 1) {
            jyjjg = jyjname + "教育局机构"
            document.getElementById("title02").innerHTML = jyjname + "教育大数据"
            document.getElementById("title03").innerHTML = jyjname + "教育大数据"
            schooltj01 = "1个"
        } else if (num == 2) {
            jyjjg = xiangzhenName + "教育局机构"
            document.getElementById("title02").innerHTML = xiangzhenName + "教育大数据"
            document.getElementById("title03").innerHTML = xiangzhenName + "教育大数据"
            schooltj01 = "0个"
        }
        schooltjhtml = " <div class=\"title02\">\n" +
            "            <div id=\"title01\">" + jyjjg + "</div>\n" +
            "            <div class=\"title03\" id=\"schooltj01\">" + schooltj01 + "</div>\n" +
            "        </div>\n"

        for (var i = 0; i < schooltjname.length; i++) {
            if (i % 2 == 0) {
                schooltjhtml = schooltjhtml + "        <div class=\"title02\">\n" +
                    "            <div class=\"title02-1\">\n" +
                    "                <div>" + schooltjname[i] + "</div>\n" +
                    "                <div class=\"title03\" >" + schooltjnum[i] + "</div>\n" +
                    "            </div>\n"
            } else {
                schooltjhtml = schooltjhtml + "            <div class=\"title02-1\">\n" +
                    "                <div>" + schooltjname[i] + "</div>\n" +
                    "                <div class=\"title03\" >" + schooltjnum[i] + "</div>\n" +
                    "            </div>\n" +
                    "        </div>"
            }

        }
        document.getElementById("schooltj").innerHTML = schooltjhtml
    }

    function getBh(jyjname) {
        var bh = ""
        if (jyjname == "恩施市") {
            bh = "ES"
        } else if (jyjname == "利川市") {
            bh = "LC"
        } else if (jyjname == "建始县") {
            bh = "JS"
        } else if (jyjname == "巴东县") {
            bh = "BD"
        } else if (jyjname == "宣恩县") {
            bh = "XE"
        } else if (jyjname == "咸丰县") {
            bh = "XF"
        } else if (jyjname == "来凤县") {
            bh = "LF"
        } else if (jyjname == "鹤峰县") {
            bh = "HF"
        }
        return bh
    }


    function getDitu(json, jyjname, xiangzhenName, schoolname, schoolType, jbh) {
        getditus[0] = json
        getditus[1] = jyjname
        getditus[2] = xiangzhenName
        getditus[3] = schoolname
        getditus[4] = schoolType

        document.getElementById("jbh").onclick = function (ev) {
            setjbh(0)
        }
        document.getElementById("jbh").innerHTML = "仅名称"

        if (schoolType == null) {
            schoolTypeNUll()
        }


        cengshu = 2
        var wid = document.documentElement.clientWidth

        document.getElementById("imgs").style.width = wid + 'px'
        document.getElementById("imgs").style.height = '60px'

        document.getElementById("spans").style.width = wid + 'px'
        document.getElementById("spans").style.height = '50px'

        document.getElementById("btns").style.width = wid + 'px'
        document.getElementById("btns").style.height = '50px'

        var ss
        $.ajax({
            async: false,
            url: "/js/json/package.json?v=20240219",//同文件夹下的json文件路径
            type: "GET",//请求方式为get
            dataType: "json", //返回数据格式为json
            success: function (data) {//请求成功完成后要执行的方法
                //console.log(data);
                ss = data
            }
        })
        var school
        if (schoollistAll != null) {
            school = schoollistAll
        } else {
            $.ajax({
                async: false,
                url: "/gis/schoolgis/getSchoolgis",//同文件夹下的json文件路径
                //url: "/js/json/school.json?v=20240220",//同文件夹下的json文件路径
                type: "POST",//请求方式为get
                dataType: "json", //返回数据格式为json
                success: function (data) {//请求成功完成后要执行的方法

                    var sch = new Array()
                    for (var i = 0; i < data.length; i++) {
                        // if (data[i].schooltype != "幼儿园") {// 隐藏幼儿园
                        var coord=data[i].coord.split(",")
                        data[i].coord=[parseFloat(coord[0]),parseFloat(coord[1])]
                        sch.push(data[i])
                        //}
                    }
                    school = sch
                    schoollistAll = sch
                }
            })

        }

        $.get(json, function (lzjson) {
                var selectjson = lzjson
                if (xiangzhenName != null) {
                    document.getElementById("back").onclick = function (ev) {
                        getDitu(json, jyjname)
                    }
                    var newMapData = [];
                    for (var i = 0; i < lzjson.features.length; i++) {
                        var provinceNames = lzjson.features[i];
                        if (provinceNames.properties.name == xiangzhenName) {
                            newMapData.push(provinceNames);
                        }
                    }
                    selectjson = {
                        "type": "FeatureCollection",
                        "features": newMapData
                    }
                } else {
                    document.getElementById("back").onclick = function () {
                        getDitu("/js/json/enshizhou.json")
                    }
                }

                echarts.registerMap('恩施州', selectjson)
                var chart = echarts.init(document.getElementById('id1'));


                var labelsize = 3
                var option = {
                    dataRange: {
                        show: false,
                        min: 0,
                        max: 500,
                        text: [],
                        realtime: true,
                        calculable: true,
                        color: ['orangered', 'yellow', 'green']
                    },
                    backgroundColor: "#0C1F34",
                    // dataZoom:{
                    //     type:'inside'
                    // },
                    tooltip: {
                        className: "custom-tooltip-bk-box", //添加一个类名
                        triggerOn: "mousemove", // 鼠标移动时触发
                        axisPointer: {
                            type: "none",
                        },
                        formatter: function (params, callback) {
                            //"markPoint"
                            // if (params.componentType == "series") {
                            //     return (
                            //         // params.seriesName +
                            //         "区域名称：" + params.name
                            //         // + "<br />学校数据：" + "恩施市学校数据"
                            //     );
                            // } else {
                            //     if (params.name.length < 5) {
                            //         return (
                            //             // params.seriesName +
                            //             "单位名称：" + params.value
                            //             // + "<br />教师数量：" + params.value
                            //             // + "<br />学生数量：" + params.value
                            //             + "<br />单位位置：" + params.data.address
                            //         );
                            //     } else {
                            //
                            //         return (
                            //             // params.seriesName +
                            //             "单位名称：" + params.name
                            //             // + "<br />教师数量：" + params.value
                            //             // + "<br />学生数量：" + params.value
                            //             + "<br />单位位置：" + params.data.address
                            //         );
                            //     }
                            // }
                        }
                    },
                    series: [
                        {
                            name: '',
                            type: 'map',
                            map: '恩施州',
                            mapLocation: {
                                y: 60
                            },
                            itemStyle: {
                                normal: {
                                    borderColor: '#FFFFFF',
                                    areaColor: {
                                        type: "linear",
                                        colorStops: [
                                            {
                                                offset: 0,
                                                color: "#0771E2",
                                            },
                                        ],
                                    }
                                }
                                ,
                                emphasis: {
                                    borderColor: '#01FFEE',
                                    borderWidth: 2,
                                    areaColor: {
                                        type: "linear",
                                        colorStops: [
                                            {
                                                offset: 0,
                                                color: "#043B76",
                                            },
                                        ],
                                    },
                                }
                            },
                            label: {
                                normal: {
                                    show: true, // 是否显示标签，默认不显示
                                    position: 'inside', // 标签位置，默认上方
                                    color: '#FFFFFF',
                                    fontSize: 14

                                },
                                emphasis: {
                                    scale: true,
                                    color: '#FFFFFF',
                                    fontWeight: 'bold'
                                }
                            },
                            roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。开启缩放'scale'，开启平移'move'。设置成 true 为都开启
                            zoom: 1.23, // 当前视角的缩放比例
                            scaleLimit: { // 滚轮缩放的极限控制，默认的缩放为1
                                min: 1,  // 最小的缩放值
                                max: 10,  // 最大的缩放值
                            },
                        }
                    ],
                };

                option.series[0].markPoint = {label: {fontSize: labelsize}, symbolSize: 12, data: []}

                if (json == '/js/json/enshizhou.json') {
                    zz = 0
                    schoollistnow = new Array()
                    option.series[0].markPoint = {
                        symbol: 'arrow',//circle,arrow,triangle,image://img/user.png
                        symbolSize: 30,
                        data: ss
                    };
                    document.getElementById("schoollist").innerHTML = "\n" +
                        "        <div class=\"title05 tutlebutton\">\n" +
                        "            <div>\n" +
                        "                <button>恩施市教育局</button>\n" +
                        "            </div>\n" +
                        "            <div>\n" +
                        "                <button>利川市教育局</button>\n" +
                        "            </div>\n" +
                        "        </div>\n" +
                        "        <div class=\"title05 tutlebutton\">\n" +
                        "            <div>\n" +
                        "                <button>建始县教育局</button>\n" +
                        "            </div>\n" +
                        "            <div>\n" +
                        "                <button>巴东县教育局</button>\n" +
                        "            </div>\n" +
                        "        </div>\n" +
                        "        <div class=\"title05 tutlebutton\">\n" +
                        "            <div>\n" +
                        "                <button>宣恩县教育局</button>\n" +
                        "            </div>\n" +
                        "            <div>\n" +
                        "                <button>咸丰县教育局</button>\n" +
                        "            </div>\n" +
                        "        </div>\n" +
                        "        <div class=\"title05 tutlebutton\">\n" +
                        "            <div>\n" +
                        "                <button>来凤县教育局</button>\n" +
                        "            </div>\n" +
                        "            <div>\n" +
                        "                <button>鹤峰县教育局</button>\n" +
                        "            </div>\n" +
                        "        </div>\n" +
                        "        <div class=\"title05 tutlebutton\">\n" +
                        "            <div>\n" +
                        "                <button style=\"padding: 5px 16px;\">恩施州高级中学</button>\n" +
                        "            </div>\n" +
                        "        </div>"
                    schooltjlist(0, school)


                    // if (zjb == null) {

                    var xzmarkPoint = new Array()
                    var xp = 1;

                    schoollistnow = new Array()

                    for (var p = 0; p < school.length; p++) {
                        var bh = ""//getBh(school[p].jyj.substring(0,3))

                        if (schoollistAll[p].value == schoollistAll[p].name) {
                            var pvalue = ""
                            if (xp < 10) {
                                pvalue = bh + "000" + xp
                            } else if (xp < 100) {
                                pvalue = bh + "00" + xp
                            } else if (xp < 1000) {
                                pvalue = bh + "0" + xp
                            } else if (xp < 10000) {
                                pvalue = bh + xp
                            }
                            pvalue = "" + xp
                            schoollistAll[p].value = pvalue
                            school[p].value = pvalue
                        }


                        if (jbh == null) {
                            //     labelsize=10
                            //     var pvalue=""
                            //     if (xp < 10) {
                            //         pvalue = bh + "000" + xp
                            //     } else if (xp < 100) {
                            //         pvalue = bh + "00" + xp
                            //     } else if (xp < 1000) {
                            //         pvalue = bh + "0" + xp
                            //     } else if (xp < 10000) {
                            //         pvalue = bh + xp
                            //     }
                            //     school[p].value=pvalue
                        }

                        //schoollistnow.push(school[p])
                        delete school[p].symbolSize
                        delete school[p].label
                        delete school[p].itemStyle

                        if (schoolType != null && schoolType != "") {
                            for (var s = 0; s < schoolType.length; s++) {
                                if (school[p].schooltype == schoolType[s]) {
                                    //school[p].symbol="image:///img/zpic.png"
                                    xzmarkPoint.push(school[p])
                                }
                            }
                        }
                        xp++
                    }

                    // option.series[0].markPoint = {
                    //     symbol: 'arrow',//circle,arrow,triangle,image://img/user.png
                    //     symbolSize: 30,
                    //     data: ss
                    // };

                    if (xzmarkPoint.length == 0) {
                        option.series[0].markPoint = {
                            // label: {fontSize: 10},
                            symbolSize: 25,
                            itemStyle: {color: "red"},
                            data: ss
                        }
                    } else {
                        option.series[0].markPoint = {
                            label: {
                                formatter: function (params) {
                                    return '{a|' + params.value + '}'; // 返回第三列值作为标记点的文本内容
                                },
                                rich: {
                                    a: {
                                        fontSize: labelsize,
                                        fontWeight: 'bold',
                                        textBorderColor: '#F41141', // 设置描边颜色为白色
                                        textBorderWidth: 3, // 设置描边线宽度
                                        shadowBlur: 8, // 设置阴影模糊程度
                                        shadowOffsetX: 2, // 设置水平阴影位移量
                                        shadowOffsetY: 2, // 设置垂直阴影位移量
                                        shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                    }
                                },
                                fontSize: labelsize,
                                borderColor: "red"
                            }, itemStyle: {color: "red"}, symbolSize: 12, data: xzmarkPoint
                        }
                        if (jbh != null) {
                            option.series[0].markPoint = {
                                label: {
                                    formatter: function (params) {
                                        return '{a|' + params.name + '}'; // 返回第三列值作为标记点的文本内容
                                    },
                                    rich: {
                                        a: {
                                            fontSize: labelsize,
                                            fontWeight: 'bold',
                                            textBorderColor: '#F41141', // 设置描边颜色为白色
                                            textBorderWidth: 3, // 设置描边线宽度
                                            shadowBlur: 8, // 设置阴影模糊程度
                                            shadowOffsetX: 2, // 设置水平阴影位移量
                                            shadowOffsetY: 2, // 设置垂直阴影位移量
                                            shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                        }
                                    },
                                    fontSize: labelsize,
                                    borderColor: "red"
                                }, itemStyle: {color: "red"}, symbolSize: 12, data: xzmarkPoint
                            }
                        }

                    }
                    // }


                } else {
                    zz = 1
                    if (jyjname != null) {
                        if (xiangzhenName != null) {
                            var xzmarkPoint = new Array()
                            var xp = 1;
                            var bh = ""//getBh(jyjname)

                            var labelsize = 3
                            for (var p = 0; p < school.length; p++) {
                                if (school[p].bsc.substring(19) == xiangzhenName) {
                                    // if (school[p].bsc == jyjname + xiangzhenName) {
                                    //xzmarkPoint.push(bh+xp)

                                    //切换编号和名称

                                    if (jbh == null) {
                                        //     labelsize=10
                                        //     if (xp < 10) {
                                        //         school[p].value = bh + "00" + xp
                                        //     } else if (xp < 100) {
                                        //         school[p].value = bh + "0" + xp
                                        //     } else if (xp < 1000) {
                                        //         school[p].value = bh + xp
                                        //     }
                                    }

                                    // school[p].symbolSize=20
                                    //
                                    // school[p].label={borderColor:"red"}
                                    //
                                    // school[p].itemStyle={borderColor:"red"}

                                    delete school[p].symbolSize
                                    delete school[p].label
                                    delete school[p].itemStyle
                                    school[p].zlevel=1
                                    if (school[p].value == schoolname || school[p].name == schoolname) {
                                        school[p].symbolSize = 70
                                        school[p].zlevel=2
                                        if(jbh!=null) {
                                            school[p].label = {
                                                fontSize: 20, color: "white", formatter: function (params) {
                                                    return '{a|' + params.name + '}'; // 返回第三列值作为标记点的文本内容
                                                },
                                                rich: {
                                                    a: {
                                                        fontWeight: 'bold',
                                                        textBorderColor: 'blue', // 设置描边颜色为白色
                                                        textBorderWidth: 3, // 设置描边线宽度
                                                        shadowBlur: 8, // 设置阴影模糊程度
                                                        shadowOffsetX: 2, // 设置水平阴影位移量
                                                        shadowOffsetY: 2, // 设置垂直阴影位移量
                                                        shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                                    }
                                                }
                                            }
                                        }else {
                                            school[p].label = {
                                                fontSize: 20, color: "white", formatter: function (params) {
                                                    return '{a|' + params.value + '}'; // 返回第三列值作为标记点的文本内容
                                                },
                                                rich: {
                                                    a: {
                                                        fontWeight: 'bold',
                                                        textBorderColor: 'blue', // 设置描边颜色为白色
                                                        textBorderWidth: 3, // 设置描边线宽度
                                                        shadowBlur: 8, // 设置阴影模糊程度
                                                        shadowOffsetX: 2, // 设置水平阴影位移量
                                                        shadowOffsetY: 2, // 设置垂直阴影位移量
                                                        shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                                    }
                                                }
                                            }
                                        }

                                        school[p].itemStyle = {color: "yellow"}
                                        //
                                        //     if (xp < 10) {
                                        //         school[p].value = bh + "00" + xp
                                        //     } else if (xp < 100) {
                                        //         school[p].value = bh + "0" + xp
                                        //     } else if (xp < 1000) {
                                        //         school[p].value = bh + xp
                                        //     }
                                    }

                                    if (schoolType != null && schoolType != "") {
                                        for (var s = 0; s < schoolType.length; s++) {
                                            if (school[p].schooltype == schoolType[s]) {
                                                xzmarkPoint.push(school[p])
                                            }
                                        }

                                        // if(school[p].schooltype==schoolType){
                                        //     xzmarkPoint.push(school[p])
                                        // }
                                    } else {
                                        xzmarkPoint.push(school[p])
                                    }


                                    xp++
                                }
                            }
                            option.series[0].markPoint = {
                                label: {
                                    formatter: function (params) {
                                        return '{a|' + params.value + '}'; // 返回第三列值作为标记点的文本内容
                                    },
                                    rich: {
                                        a: {
                                            fontWeight: 'bold',
                                            textBorderColor: '#F41141', // 设置描边颜色为白色
                                            textBorderWidth: 3, // 设置描边线宽度
                                            shadowBlur: 8, // 设置阴影模糊程度
                                            shadowOffsetX: 2, // 设置水平阴影位移量
                                            shadowOffsetY: 2, // 设置垂直阴影位移量
                                            shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                        }
                                    }
                                    ,fontSize:5
                                },symbolSize:30, itemStyle: {color: "red"}, data: xzmarkPoint
                            }
                            if (jbh != null) {
                                option.series[0].markPoint = {
                                    label: {
                                        formatter: function (params) {
                                            return '{a|' + params.name + '}'; // 返回第三列值作为标记点的文本内容
                                        },
                                        rich: {
                                            a: {
                                                fontWeight: 'bold',
                                                textBorderColor: '#F41141', // 设置描边颜色为白色
                                                textBorderWidth: 3, // 设置描边线宽度
                                                shadowBlur: 8, // 设置阴影模糊程度
                                                shadowOffsetX: 2, // 设置水平阴影位移量
                                                shadowOffsetY: 2, // 设置垂直阴影位移量
                                                shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                            }
                                        } ,fontSize:5
                                    }, symbolSize:30,itemStyle: {color: "red"}, data: xzmarkPoint
                                }
                            }


                        } else
                            {
                            var xzmarkPoint = new Array()
                            var xp = 1;
                            var bh = ""//getBh(jyjname)

                            var labelsize = 3
                            for (var p = 0; p < school.length; p++) {
                                if (school[p].jyj == jyjname + "教育局") {
                                    //xzmarkPoint.push(bh+xp)
                                    // if (school[p].value != schoolname) {
                                    //
                                    //     if (xp < 10) {
                                    //         school[p].value = bh + "00" + xp
                                    //     } else if (xp < 100) {
                                    //         school[p].value = bh + "0" + xp
                                    //     } else if (xp < 1000) {
                                    //         school[p].value = bh + xp
                                    //     }
                                    // }
                                    //切换编号和名称
                                    if (jbh == null) {

                                        //     labelsize=10
                                        //     if (xp < 10) {
                                        //         school[p].value = bh + "00" + xp
                                        //     } else if (xp < 100) {
                                        //         school[p].value = bh + "0" + xp
                                        //     } else if (xp < 1000) {
                                        //         school[p].value = bh + xp
                                        //     }
                                    }

                                    // school[p].symbolSize=12

                                    delete school[p].symbolSize
                                    delete school[p].label
                                    delete school[p].itemStyle

                                    if (schoolType != null && schoolType != "") {
                                        for (var s = 0; s < schoolType.length; s++) {
                                            if (school[p].schooltype == schoolType[s]) {

                                                xzmarkPoint.push(school[p])
                                            }
                                        }
                                        // if(school[p].schooltype==schoolType){
                                        //     xzmarkPoint.push(school[p])
                                        // }
                                    } else {
                                        xzmarkPoint.push(school[p])
                                    }

                                    xp++
                                }
                            }

                            option.series[0].markPoint = {
                                itemStyle: {color: "red"},
                                label: {
                                    formatter: function (params) {
                                        return '{a|' + params.value + '}'; // 返回第三列值作为标记点的文本内容
                                    },
                                    rich: {
                                        a: {
                                            fontSize: labelsize,
                                            fontWeight: 'bold',
                                            textBorderColor: '#F41141', // 设置描边颜色为白色
                                            textBorderWidth: 3, // 设置描边线宽度
                                            shadowBlur: 8, // 设置阴影模糊程度
                                            shadowOffsetX: 2, // 设置水平阴影位移量
                                            shadowOffsetY: 2, // 设置垂直阴影位移量
                                            shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                        }
                                    },
                                    fontSize: labelsize
                                }, effect: {
                                    show: true,
                                    shadowBlur: 0
                                }, symbolSize: 12, data: xzmarkPoint
                            }
                            if (jbh != null) {
                                option.series[0].markPoint = {
                                    itemStyle: {color: "red"},
                                    label: {
                                        formatter: function (params) {
                                            return '{a|' + params.name + '}'; // 返回第三列值作为标记点的文本内容
                                        },
                                        rich: {
                                            a: {
                                                fontSize: labelsize,
                                                fontWeight: 'bold',
                                                textBorderColor: '#F41141', // 设置描边颜色为白色
                                                textBorderWidth: 3, // 设置描边线宽度
                                                shadowBlur: 8, // 设置阴影模糊程度
                                                shadowOffsetX: 2, // 设置水平阴影位移量
                                                shadowOffsetY: 2, // 设置垂直阴影位移量
                                                shadowColor: 'rgba(0, 0, 0, 0.4)' // 设置阴影颜色及透明度
                                            }
                                        },
                                        fontSize: labelsize
                                    }, effect: {
                                        show: true,
                                        shadowBlur: 0
                                    }, symbolSize: 12, data: xzmarkPoint
                                }
                            }


                        }

                        var j = 0;

                        schoollistnow = new Array()
                        var schooltj = new Array()
                        for (var i = 0; i < school.length; i++) {
                            if (xiangzhenName == null) {
                                if (school[i].jyj == jyjname + "教育局") {//       if (school[i].jyj == jyjname + "教育局") {
                                    schooltj.push(school[i])
                                    j++
                                    schoollistnow.push(school[i])
                                }
                            } else {
                                // if (school[i].bsc == jyjname + xiangzhenName) {
                                if (school[i].bsc.substring(19) == xiangzhenName) {
                                    schooltj.push(school[i])
                                    j++
                                    schoollistnow.push(school[i])
                                }
                            }
                        }
                        if (xiangzhenName == null) {
                            schooltjlist(1, schooltj, jyjname)
                        } else {
                            schooltjlist(2, schooltj, jyjname, xiangzhenName)
                        }


                        var schoollisthtml = ""
                        if (schoollistnow.length > 0) {

                            var bh = ""//getBh(schoollistnow[0].jyj.substring(0, 3))

                            for (var i = 0; i < schoollistnow.length; i = i + 2) {
                                if (i < (schoollistpageNum - 1)) {
                                    //  var sch01 = schoollistnow[i].name
                                    var sch01 = schoollistnow[i].name
                                    var bhid = schoollistnow[i].value
                                    if (sch01.length > 10) {
                                        sch01 = sch01.substring(3)
                                        if (sch01.length > 10) {
                                            sch01 = sch01.substring(0, 5) + "..." + sch01.substring(sch01.length - 5)
                                        }
                                    }
                                    sch01 = bhid + sch01
                                    // if (xiangzhenName != null) {


                                    // if (i + 1 < 10) {
                                    //     sch01 = bh + "00" + (i + 1) + sch01
                                    // } else if (i + 1 < 100) {
                                    //     sch01 = bh + "0" + (i + 1) + sch01
                                    // } else if (i + 1 < 1000) {
                                    //     sch01 = bh + (i + 1) + sch01
                                    // }


                                    //}

                                    if (i + 1 < schoollistnow.length) {
                                        // var sch02 = schoollistnow[i + 1].name
                                        var sch02 = schoollistnow[i + 1].name
                                        var bhid2 = schoollistnow[i + 1].value
                                        if (sch02.length > 10) {
                                            sch02 = sch02.substring(3)
                                            if (sch02.length > 10) {
                                                sch02 = sch02.substring(0, 5) + "..." + sch02.substring(sch02.length - 5)
                                            }
                                        }
                                        sch02 = bhid2 + sch02
                                        // if (xiangzhenName != null) {

                                        // if (i + 1 < 10) {
                                        //     sch02 = bh + "00" + (i + 2) + sch02
                                        // } else if (i + 1 < 100) {
                                        //     sch02 = bh + "0" + (i + 2) + sch02
                                        // } else if (i + 1 < 1000) {
                                        //     sch02 = bh + (i + 2) + sch02
                                        // }

                                        //}
                                        schoollisthtml = schoollisthtml + " <div class=\"title05\">" +
                                            "<div><button onclick='show(" + i + ",1)'title='" + schoollistnow[i].name + "'>" + sch01 + "</button></div>" +
                                            "<div> <button onclick='show(" + (i + 1) + ",1)'title='" + schoollistnow[i + 1].name + "'>" + sch02 + "</button></div>" +
                                            "</div>"
                                    } else {
                                        schoollisthtml = schoollisthtml + " <div class=\"title05\">" +
                                            "<div><button onclick='show(" + i + ",1)'title='" + schoollistnow[i].name + "' style=\"padding: 5px 16px;\">" + sch01 + "</button></div>" +
                                            "</div>"
                                    }
                                }
                            }

                            pageall = Math.ceil(schoollistnow.length / schoollistpageNum)
                            pagenow = 1
                            if (schoollistnow.length > schoollistpageNum) {
                                schoollisthtml = schoollisthtml + "<div class='pages title05'><div style='width: 100%;'> " +
                                    "<span onclick='pageTo(-1,\"" + xiangzhenName + "\")'>上一页</span>" +
                                    "<span style='color: white;padding: 0 2px 0 10px'>1</span>" +
                                    "<span style='color: white;padding: 0 2px 0 2px'>/</span>" +
                                    "<span style='color: white;padding: 0 10px 0 2px'>" + pageall + "</span>" +
                                    "<span  onclick='pageTo(1,\"" + xiangzhenName + "\")'>下一页</span></div><div"
                            }

                        }

                        if (schoolname == null) {
                            document.getElementById("schoollist").innerHTML = schoollisthtml
                        }

                    }
                }


                if (schoolType == null || schoolType == "null") {
                    document.getElementById("schoolType").value = null
                }

                chart.off('georoam')
                chart.on('georoam', function (params) {

                    // console.log("chart.offsetWidth=" + document.getElementById('id1').offsetWidth)

                    if (params.zoom != null) {
                        if (params.zoom > 1) {
                            if (cengshu < 13) {
                                cengshu++
                            }
                        } else {
                            if (cengshu > 0) {
                                cengshu--
                            }
                        }

                        var option = chart.getOption();

                        var fontSize = 12;
                        option.series[0].label.show = true;
                        if (cengshu < 3) {
                            fontSize = 18;
                        } else if (cengshu < 8) {
                            fontSize = 16;
                        } else if (cengshu < 10) {
                            fontSize = 14;
                        } else if (cengshu == 13) {
                            fontSize = 12;
                            option.series[0].label.show = false;
                        }

                        if (xiangzhenName == null) {
                            if(cengshu<5){
                                option.series[0].markPoint.label.rich.a.fontSize = cengshu + 1
                            }else {
                                option.series[0].markPoint.label.rich.a.fontSize = 6
                            }

                            option.series[0].markPoint.symbolSize = cengshu + 10
                            option.series[0].label.fontSize = fontSize;
                        }

                        chart.clear()
                        chart.setOption(option);
                    }

                })
                chart.off('click')
                chart.on('click', function (params) {
                    var indexof = params.name.indexOf("教育局")
                    if (indexof != -1) {
                        layer.open({
                            closeBtn: 0,
                            skin: 'demo-class',
                            type: 1,
                            area: ['300px', '200px'],
                            //closeBtn :0,

                            content: "<div>单位名称：" + params.name + "</div>" + "<div>单位地点：" + params.data.address + "</div>",
                            btn: ['关闭'],
                            btn1: function (index) {
                                layer.close(index)
                            }
                        });
                    }
                    if (params.componentType != "markPoint") {
                        if (xiangzhenName == null) {
                            if ('/js/json/enshizhou.json' != json) {
                                getDitu(json, jyjname, params.name)
                            }
                            if (params.name == "恩施市") {
                                getDitu('/js/json/enshishi.json?v=20240220', "恩施市")
                            } else if (params.name == "利川市") {
                                getDitu('/js/json/lichuan.json?v=2024', "利川市")
                            } else if (params.name == "建始县") {
                                getDitu('/js/json/jianshi.json?v=2024', "建始县")
                            } else if (params.name == "巴东县") {
                                getDitu('/js/json/badong.json?v=2024', "巴东县")
                            } else if (params.name == "鹤峰县") {
                                getDitu('/js/json/hefeng.json?v=20242', "鹤峰县")
                            } else if (params.name == "来凤县") {
                                getDitu('/js/json/laifeng.json?v=20242', "来凤县")
                            } else if (params.name == "咸丰县") {
                                getDitu('/js/json/xianfeng.json?v=2024', "咸丰县")
                            } else if (params.name == "宣恩县") {
                                getDitu('/js/json/xuanen.json?v=202422', "宣恩县")
                            }
                        }

                    }
                    // else {
                    //     if (params.componentType != "markPoint") {
                    //         getDitu('/js/json/enshizhou.json')
                    //     }
                    // }
                    if (params.componentType == "markPoint") {
                        if (params.value != null) {
                            var showi = 0;
                            if (params.value.length > 5) {

                                for (var p = 0; p < schoollistAll.length; p++) {
                                    if (schoollistAll[p].value == params.value) {
                                        showi = p
                                    }
                                }

                                // if (zz == 0) {
                                //     for (var p = 0; p < schoollistAll.length; p++) {
                                //         if (schoollistAll[p].name == params.value) {
                                //             showi = p
                                //         }
                                //     }
                                // } else {
                                //     for (var p = 0; p < schoollistnow.length; p++) {
                                //         if (schoollistnow[p].name == params.value) {
                                //             showi = p
                                //         }
                                //     }
                                // }

                            } else {
                                //var value = Array.from(params.value);
                                // if (value[2] != 0) {
                                //     showi = Number(value[2] * 100)
                                // }
                                // if (value[3] != 0) {
                                //     showi = Number(showi) + Number(value[3] * 10)
                                // }
                                // if (value[4] != 0) {
                                //     showi = Number(showi) + Number(value[4])
                                // }
                                //
                                //showi = showi - 1
                                showi = params.value - 1
                            }

                            show(showi)
                        }
                    }
                    // if (params.name == "板桥镇"||params.name == "建南镇"||params.name == "业州镇"
                    //     ||params.name == "绿葱坡镇") {
                    //     getDitu('/js/json/enshizhou.json')
                    // }

                })

                chart.clear()
                chart.setOption(option);

            }
        );
    }


    getDitu('/js/json/enshizhou.json', null, null, null, null, 1)


    var pageevernum = 20

    function searchPageTo(num) {
        var pageall = Math.ceil(schoolSeacrchList.length / pageevernum)
        var schoollisthtml = ""
        var pagelast = num * pageevernum
        if (schoolSeacrchList.length < pagelast) {
            pagelast = schoolSeacrchList.length
        }
        for (var i = (num - 1) * pageevernum; i < pagelast; i = i + 2) {
            var sch01 = schoolSeacrchList[i].name
            if (sch01.length > 10) {
                sch01 = sch01.substring(3)
                if (sch01.length > 10) {
                    sch01 = sch01.substring(0, 5) + "..." + sch01.substring(sch01.length - 5)
                }
            }
            sch01 = schoolSeacrchList[i].value + sch01

            if (i + 1 < schoolSeacrchList.length) {
                var sch02 = schoolSeacrchList[i + 1].name
                if (sch02.length > 10) {
                    sch02 = sch02.substring(3)
                    if (sch02.length > 10) {
                        sch02 = sch02.substring(0, 5) + "..." + sch02.substring(sch02.length - 5)
                    }
                }

                sch02 = schoolSeacrchList[i + 1].value + sch02


                schoollisthtml = schoollisthtml + " <div class=\"title05\">" +
                    "<div><button onclick='searchDituShow(" + JSON.stringify(schoolSeacrchList[i]) + ")' title='" + schoolSeacrchList[i].name + "' >" + sch01 + "</button></div>" +
                    "<div> <button onclick='searchDituShow(" + JSON.stringify(schoolSeacrchList[i + 1]) + ")'title='" + schoolSeacrchList[i + 1].name + "' >" + sch02 + "</button></div>" +
                    "</div>"
            } else {
                schoollisthtml = schoollisthtml + " <div class=\"title05\">" +
                    "<div><button onclick='searchDituShow(" + JSON.stringify(schoolSeacrchList[i]) + ")' title='" + schoolSeacrchList[i].name + "'style=\"padding: 5px 16px;\">" + sch01 + "</button></div>" +
                    "</div>"
            }
        }
        if (schoolSeacrchList.length > pageevernum) {

            var numlast = num
            var numnext = num
            if (num > 1) {
                numlast = numlast - 1
            }
            if (num < pageall) {
                numnext = numnext + 1
            }

            schoollisthtml = schoollisthtml + "<div class='pages title05'><div style='width: 100%;'>" +
                "<span onclick='searchPageTo(" + numlast + ")'>上一页</span>" +
                "<span style='color: white;padding: 0 2px 0 10px'>" + num + "</span>" +
                "<span style='color: white;padding: 0 2px 0 2px'>/</span>" +
                "<span style='color: white;padding: 0 10px 0 2px'>" + pageall + "</span>" +
                "<span  onclick='searchPageTo(" + numnext + ")'>下一页</span></div><div"
        }
        document.getElementById("schoollist").innerHTML = schoollisthtml
    }


    function searchDituShow(school) {

        var jons = getJsonName(school).split(",")
        getDitu(jons[0], jons[1], school.bsc.substring(19), school.name)

        changes(0)
    }

    function searchSchool() {
        var schoolname = document.getElementById("schoolname").value
        schoolname = schoolname.replace(/\s*/g, "");//去掉空格
        console.log("schoolname=" + schoolname)
        if (schoolname != "") {
            schoolSeacrchList = new Array()
            for (var i = 0; i < schoollistAll.length; i++) {
                if (schoollistAll[i].name.indexOf(schoolname) != -1) {
                    schoolSeacrchList.push(schoollistAll[i])
                }
            }
            console.log(schoolSeacrchList)
            searchPageTo(1)
        }
    }
</script>
</body>
</html>
