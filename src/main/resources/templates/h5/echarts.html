<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <th:block th:include="include :: header('恩施地图')"/>
    <title>恩施地图</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    <style type="text/css">
        #id1 {
            border: 2px solid #0C1F34;
            height: 640px;
        }
        .my-skin{
            width: 100px;
        }
        .my-skin .layui-layer-btn a {
            background-color: #84c101;
            border: 1px solid #84c101;
            color: #FFF;
        }
    </style>

</head>

<body>
<div id="imgs" style="position: relative;background-color:#0C1F34;">
    <img   style="position:absolute;z-index: 99;background-color: #0C1F34;width: 100%;height: 100%" src="/img/bigdatatitle.png">
</div>
<div  id="spans" style="position: relative;background-color: rgba(12, 31, 52, 0);top: -40px;z-index: 100;text-align: center">
    <div style="color: white;font-size: 25px">恩施地图</div>
</div>
<div id="id1" style="top: -50px;">

</div>

<!--<a href="http://api.map.baidu.com/marker?location=30.282406,109.486761&title=恩施&output=html">百度地图1</a>-->

<!--<a href="http://api.map.baidu.com/direction?origin=30.282406,109.486761&destination=30.382406,109.586761&mode=driving&region=恩施&output=html">2百度地图</a>-->

<!--<a href="https://uri.amap.com/marker?position=109.586761,30.382406&name=恩施0">高德地图1</a>-->

<!--<a href="http://uri.amap.com/navigation?from=109.486761,30.282406&to=109.586761,30.382406&name=恩施2&mode=car&src=nyx_super;">高德地图2</a>-->


<script src="/js/mmlib.min.js"></script>
<script src="/js/common.js"></script>
<script src="/js/json/echarts-all.min.js"></script>

<script type="text/javascript">
    getDitu('/js/json/enshizhou.json')

    function getDitu(json,ii) {
        var wid=document.documentElement.clientWidth

        document.getElementById("imgs").style.width=wid+'px'
        document.getElementById("imgs").style.height='50px'

        document.getElementById("spans").style.width=wid+'px'
        document.getElementById("spans").style.height='50px'


        $.get(json, function (lzjson) {
            echarts.registerMap('恩施州', lzjson)
            var chart = echarts.init(document.getElementById('id1'));
            var option = {

                dataRange: {
                    show: false,
                    min: 0,
                    max: 500,
                    text: [],
                    realtime: true,
                    calculable: true,
                    color: ['orangered', 'yellow', 'green']
                },
                backgroundColor: "#0C1F34",

                tooltip: {
                    className: "custom-tooltip-bk-box", //添加一个类名
                    triggerOn: "mousemove", // 鼠标移动时触发
                    axisPointer: {
                        type: "none",
                    },
                    formatter: function (params, callback) {

                        //"markPoint"
                        if (params.componentType == "series") {
                            return (
                                // params.seriesName +
                                "地市名称：" + params.name
                                + "<br />学校数据：" + "恩施市学校数据"
                            );
                        } else {
                            return (
                                // params.seriesName +
                                "学校名称：" + params.name
                                + "<br />教师数量：" + params.value
                                + "<br />学生数量：" + params.value
                                + "<br />学校位置：" + params.data.coord
                            );
                        }
                    }
                },
                series: [
                    {
                        name: '',
                        type: 'map',
                        map: '恩施州',

                        mapLocation: {
                            y: 60
                        },
                        itemStyle: {
                            normal: {
                                borderColor: '#FFFFFF',
                                areaColor: {
                                    type: "linear",
                                    colorStops: [
                                        {
                                            offset: 0,
                                            color: "#0771E2",
                                        },
                                    ],
                                }
                            },
                            emphasis: {
                                borderColor: '#01FFEE',
                                borderWidth: 2,
                                areaColor: {
                                    type: "linear",
                                    colorStops: [
                                        {
                                            offset: 0,
                                            color: "#043B76",
                                        },
                                    ],
                                },
                            }
                        },
                        label: {
                            normal: {
                                show: true, // 是否显示标签，默认不显示
                                position: 'inside', // 标签位置，默认上方
                                color: '#FFFFFF',
                                fontSize: 20

                            },
                            emphasis: {
                                color: '#FFFFFF',
                                fontWeight: 'bold'
                            }
                        },
                        roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。开启缩放'scale'，开启平移'move'。设置成 true 为都开启
                        zoom: 1.23, // 当前视角的缩放比例
                        scaleLimit: { // 滚轮缩放的极限控制，默认的缩放为1
                            min: 1,  // 最小的缩放值
                            max: 10,  // 最大的缩放值
                        },
                    }
                ],

            };
            if (ii == 1) {
                option.series[0].markPoint = {
                    symbol: 'pin',//circle,arrow,triangle
                    symbolSize: 30,
                    data: [{
                        name: '恩施市一中',
                        value: '恩施市一中',
                        coord: [109.486761, 30.282406],
                        // itemStyle: {
                        //     color: "#E9FA3B" // 设置 markPoint 的颜色为红色
                        // },
                        // label: {
                        //     color: "#06F330"
                        // }

                    }, {
                        name: '恩施市二中',
                        value: '恩施市二中',
                        coord: [109.586761, 30.382406]

                    }]

                };
            }else {
                option.series[0].markPoint = { data: []}
            }

            chart.on('click', function (params) {

                if (params.name == "恩施市二中") {
                    var isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                    //判断是否在手机端，手机端则进导航选择
                    if (isMobile) {
                        var ss=layer.confirm("请选择导航地图!", {

                             area:["200px","200px"],

                            btn: ['百度', '高德', '取消'],
                            btn1: function () {
                                //location.href="http://api.map.baidu.com/direction?origin=30.282406,109.486761&destination=30.382406,109.586761&mode=driving&region=恩施&output=html"
                                location.href = "http://api.map.baidu.com/marker?location=30.282406,109.486761&title=恩施&output=html"
                            }, btn2: function () {
                                location.href = "https://uri.amap.com/marker?position=109.586761,30.382406&name=恩施市二中"
                            }, btn3: function (index) {
                                layer.close(index)
                            }
                        });
                        layer.style(ss, {
                            width: '200px',
                            height:'200px'
                        });
                        $('.layui-layer-dialog').width('200px ');
                    }


                }

                console.log(params)
                if (params.name == "恩施市") {
                    getDitu('/js/json/enshishi.json',1)
                } else if (params.name == "利川市") {
                    getDitu('/js/json/lichuan.json')
                } else if (params.name == "建始县") {
                    getDitu('/js/json/jianshi.json')
                } else if (params.name == "巴东县") {
                    getDitu('/js/json/badong.json')
                } else if (params.name == "鹤峰县") {
                    getDitu('/js/json/hefeng.json')
                } else if (params.name == "来凤县") {
                    getDitu('/js/json/laifeng.json')
                } else if (params.name == "咸丰县") {
                    getDitu('/js/json/xianfeng.json')
                } else if (params.name == "宣恩县") {
                    getDitu('/js/json/xuanen.json')
                } else {
                    if(params.componentType!="markPoint"){
                        getDitu('/js/json/enshizhou.json')
                    }
                }


                // if (params.name == "板桥镇"||params.name == "建南镇"||params.name == "业州镇"
                //     ||params.name == "绿葱坡镇") {
                //     getDitu('/js/json/enshizhou.json')
                // }

            })
            chart.setOption(option);

        });
    }

</script>
</body>
</html>
